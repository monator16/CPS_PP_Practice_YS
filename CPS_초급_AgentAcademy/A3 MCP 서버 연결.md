# 1. 목표


* 모델 컨텍스트 프로토콜(MCP) 표준의 이해 및 활용
* Agent 365를 활용하여 MCP 서버와 Copilot Studio 에이전트 통합
* Copilot Studio 에이전트를 MCP 서버에 연결하는 방법
* 에이전트 내에서 MCP 서버 기능 활용하기

# 2. 배경지식

## MCP란 무엇인가요?

**모델 컨텍스트 프로토콜(MCP)**은 AI 어시스턴트가 외부 데이터 소스 및 도구와 안전하게 연결될 수 있도록 지원하는 오픈 표준입니다.

MCP를 **'AI 통합을 위한 USB-C'**라고 생각하면 이해하기 쉽습니다. USB-C가 다양한 기기와 주변기기를 연결하는 범용 커넥터 역할을 하듯, MCP는 AI 시스템이 다양한 서비스, 데이터베이스, 애플리케이션에 연결할 수 있는 표준화된 방식을 제공합니다.

USB-C 이전에는 기기마다 제각각인 커넥터를 사용해야 했던 불편함(수많은 충전 케이블을 떠올려보세요)이 있었습니다. 마찬가지로 MCP 이전에는 AI 에이전트를 외부 시스템에 연결할 때마다 각 서비스에 맞춘 개별적인 통합 작업이 필요했습니다. MCP는 범용 '플러그 앤 플레이' 프로토콜을 제공하여 이러한 문제를 해결합니다.

### MCP의 주요 장점

* **범용 연결성:** 하나의 표준 프로토콜로 다양한 AI 플랫폼과 데이터 소스에서 작동합니다.
* **보안 접근:** 내장된 인증 및 권한 제어 기능을 통해 데이터를 보호합니다.
* **확장성:** 핵심 로직을 다시 작성하지 않고도 에이전트에 새로운 기능을 쉽게 추가할 수 있습니다.
* **상호운용성:** MCP 서버는 여러 AI 어시스턴트 및 애플리케이션과 호환됩니다.

이번 미션에서는 MCP를 사용하여 Copilot Studio 에이전트를 외부 서비스와 연결하고, 에이전트가 기본 기능을 넘어 훨씬 더 광범위한 작업을 수행하도록 확장하게 됩니다.

## Agent 365의 역할

Agent 365는 기업 규모에서 AI 에이전트를 안전하고 효율적으로 관리·확장하기 위한 Microsoft 플랫폼입니다.
핵심 기능:

고유 ID 관리: Microsoft Entra 기반으로 에이전트 신원, 접근 권한, 수명 주기 관리
MCP 서버 제공: 비즈니스 시스템과 안전하게 연결하는 엔터프라이즈 MCP 인프라
제어 평면 역할: 보안, 거버넌스, 모니터링을 담당하며 Microsoft 365 및 앱과 표준화된 방식으로 연동

즉, 에이전트 운영을 위한 관리·보안·개발 프레임워크입니다.

## MCP 통합을 위한 Agent 365 툴링 서버

Agent 365는 에이전트가 비즈니스 시스템에 안전하게 접근할 수 있도록 **엔터프라이즈급 MCP 서버**를 제공합니다.

### 1. Microsoft 365 및 비즈니스 앱용 사전 구축 MCP 서버

* **Outlook 캘린더:** 일정 생성, 업데이트 및 관리.
* **Outlook 메일:** 이메일 발송, 읽기, 검색.
* **Teams:** 채팅 생성, 메시지 게시, 채널 관리.
* **SharePoint & OneDrive:** 파일 업로드, 목록 관리, 문서 검색.
* **Word:** 문서 생성 및 편집, 댓글 추가.
* **Dataverse & Dynamics 365:** 비즈니스 데이터에 대한 CRUD(생성, 읽기, 갱신, 삭제) 작업 수행.
* **사용자 프로필:** 사용자 정보 조회, 관리자 및 직속 부하 직원 정보 접근.
* **Copilot 검색:** Microsoft 365 Copilot과 채팅 및 파일 기반 응답 생성.

### 2. 기업 보안 및 거버넌스

* **중앙 집중식 제어:** Microsoft 365 관리 센터를 통해 모든 MCP 서버를 관리하며 조직 전체에서 허용/차단 설정.
* **범위별 권한(Scoped Permissions):** 에이전트는 Microsoft Entra 범위에 따라 필요한 리소스에만 접근.
* **완전한 관측성:** Microsoft Defender Advanced Hunting을 통해 모든 도구 호출을 모니터링 및 감사.
* **정책 집행:** 실행 시 DLP, MIP, 속도 제한, 보안 스캔 적용.
* **위협 보호:** Microsoft Defender 통합을 통해 에이전트를 표적으로 한 공격 탐지 및 대응.

### 3. 맞춤형 MCP 서버 생성

* API 기반 커스텀 서버 구축
* 1,500+ Power Platform 커넥터 연결
* Graph API, REST API, Dataverse 통합
* 조직 전용 서버 배포 및 인증

### 4. 개발자 경험

* **접근성:** Copilot Studio(로우코드)와 Azure AI Foundry(프로코드) 모두에서 사용 가능.
* **통합 SDK:** Agent 365 SDK에 내장되어 원활한 통합 지원.
* **VS Code:** Visual Studio Code 통합을 통한 커스텀 MCP 서버 생성 및 테스트.
* **표준화:** 모든 툴링 서버 간 일관된 인터페이스 제공.


## 에이전트에게 중요한 이유

Agent 365는 MCP를 단순한 오픈 표준에서 엔터프라이즈 수준의 플랫폼으로 격상시킵니다.

- 안전성: 모든 호출 추적, 보안 내장
- 신뢰성: MCP 서버는 성능·지연·정확성 검증 완료
- 빠른 개발: 일반 시나리오는 사전 구축 서버, 특수 요구는 커스터마이징
- 통합 관리: 모든 에이전트를 하나의 제어 평면에서 관리


# 3. 실습: 면접 준비 미팅을 위한 MCP 서버 추가하기

Agent 365는 포괄적인 플랫폼을 제공하지만, 이번에는 **Copilot Studio에서 사전 구축된(Pre-built) MCP 서버를 사용하는 방법**에 집중합니다.

복잡한 코딩 없이, 에이전트를 Outlook 캘린더나 Teams 같은 기존 툴링 서버에 연결하여 Microsoft 365 애플리케이션에서 실제 작업을 수행하게 만드는 방법을 배울 것입니다. 이미 가지고 있는 도구를 더 잘 활용하는 방법을 배우는 것과 같습니다.


> **중요:** 이 실습을 위해서는 Microsoft Agent 365에 조기 접근할 수 있는 **Frontier 프리뷰 프로그램**에 참여해야 합니다. 해당 기능은 개발 중이므로 가용성과 기능이 변경될 수 있습니다.

<img width="2283" height="1339" alt="Image" src="https://github.com/user-attachments/assets/ab10f511-ab6a-4ea1-a067-836b9348504b" />

## 사전 준비 사항 (필수)

이 실습에서는 **Microsoft 365 사용자 프로필 MCP 서버**와 **Microsoft Outlook 캘린더 MCP 서버**를 추가합니다. 원활한 진행을 위해 테넌트에서 다음 사항을 미리 설정해야 합니다.

1. **관리자 설정:** M365 관리 센터에서 현재 사용자의 관리자를 설정하세요.
2. **일정 예약:** 향후 24시간 이내에 테스트용 회의 일정을 하나 예약해 두세요 ("오늘 회의 일정을 알려줘"라고 테스트하기 위함).
3. **추가 사용자 생성:** 면접 준비 미팅에 초대할 테넌트 내 추가 사용자를 생성하세요.
4. **메일함 설정:** 추가 사용자의 메일함을 프로비저닝하고, 근무일/시간을 설정하는 것을 권장합니다.

MCP 서버는 기존 커넥터와 달리, 서버당 하나의 도구만 추가하면 여러 작업을 처리할 수 있어 관리가 훨씬 쉽습니다.


## 1단계: Microsoft 365 사용자 프로필 MCP 서버 추가

1. **Copilot Studio**를 열고 이전에 생성한 '인터뷰 에이전트'를 엽니다.
2. 상단 내비게이션에서 **도구(Tools)**를 선택합니다.
3. **+ 도구 추가(+ Add tool)**를 클릭합니다.
4. 필터에서 **모델 컨텍스트 프로토콜(Model Context Protocol)**을 선택하여 목록을 좁힙니다.
5. 목록에서 **Microsoft 365 User Profile MCP Server**를 선택합니다.
6. 연결 드롭다운에서 **새 연결 만들기(New connection)**를 선택합니다.
7. **생성(Create)**을 눌러 연결 과정을 시작하고, 팝업에서 계정을 선택하여 연결합니다.
8. 연결 후 **추가 및 구성(Add and config)**을 선택하여 에이전트에 서버를 추가합니다.
9. 도구 개요 페이지 하단에서 포함된 MCP 도구 목록을 확인할 수 있습니다.
10. **테스트(Test)**를 선택하고, 테스트 창(Test your agent)에 다음 프롬프트를 입력하세요:
> `Who is my manager?`


11. **허용(Allow)**을 선택하여 MCP 서버의 데이터 접근에 동의합니다. (이 동의 카드는 에이전트와 MCP 서버 조합당 최초 1회만 표시됩니다.)
12. 에이전트가 답변을 제공하며, 왼쪽의 테스트 창에서 `getMyManager` 도구가 실행된 세부 정보(보낸 값/받은 값)를 확인할 수 있습니다.

**추가 테스트:**
이제 테넌트 내 사용자에 대해 다음과 같은 질문도 가능합니다:

* `Who are my direct reports?` (내 직속 부하 직원은 누구지?)
* `What is the job role of [사용자 이름]?` ([사용자]의 직무는 뭐지?)

준비가 되셨다면 다음 단계로 넘어갑니다.



## 2단계: Microsoft Outlook 캘린더 MCP 서버 추가하기

사용자 프로필 서버로는 미팅 상대를 찾을 수 있지만, 실제 미팅을 잡기 위해서는 캘린더 기능이 필요합니다. 사용자가 다음과 같이 요청할 때를 대비해 봅시다.

> `meeting with Daniel Laskewitz tomorrow`

1. 상단 내비게이션에서 **도구(Tools)**를 선택합니다.
2. **+ 도구 추가**를 선택하고, 다시 **모델 컨텍스트 프로토콜**로 필터링합니다.
3. 스크롤을 내려 **Microsoft Outlook Calendar MCP Server**를 선택합니다.
4. **추가 및 구성(Add and config)**을 선택합니다.
5. 도구 목록을 확인한 후, 테스트를 위해 다음 프롬프트를 입력합니다:
> `Get my meetings for today`


6. 새로운 MCP 서버이므로 다시 **허용(Allow)**을 선택하여 데이터 접근에 동의합니다.
7. 오늘의 회의 일정 목록을 답변으로 받게 됩니다.


## 3단계: 면접 준비 미팅 계획하기 (최종 미션)

이제 두 MCP 서버가 모두 작동하므로, 실제로 면접 준비 미팅을 잡아보겠습니다.

1. 테스트 창 상단의 **새로 고침(Refresh/New Start)** 아이콘을 눌러 새 세션을 시작합니다.
2. 다음 프롬프트를 입력하세요 (Jane Doe 대신 실제 생성한 사용자 이름 사용):
> `Can you find 3 meeting times for a 30 minute meeting with Jane Doe for an interview prep-meeting?`


3. 에이전트가 `findMeetingTimes` 도구를 실행하여, 귀하와 상대방의 캘린더 가용성을 확인하고 3가지 시간 옵션을 제안할 것입니다.
4. 제안된 시간 중 하나를 선택하여 미팅을 확정합니다 (시간은 실제 제안된 시간으로 변경):
> `Please schedule the one on 10:30 AM UTC`


5. `createEvent` 도구가 실행되며 회의 일정이 생성됩니다.
6. 상대방(Jane Doe)의 메일함에서 미팅 요청이 도착했는지 확인해보세요.

이것으로 실습이 종료되었습니다. MCP 서버가 에이전트의 업무 수행 능력을 어떻게 향상시키는지 이해하셨기를 바랍니다!


# 참고 자료

* Microsoft Copilot Studio & MCP Labs
* 모델 컨텍스트 프로토콜(MCP) 시작하기
* Copilot Studio에서 MCP로 에이전트 확장하기
* Microsoft Agent 365 개요
* Microsoft Agent 365 툴링 서버 개요
* Microsoft 365 사용자 프로필 MCP 서버 가이드
* Microsoft Outlook 캘린더 MCP 서버 가이드
* 사용자 추가 및 라이선스 할당 방법